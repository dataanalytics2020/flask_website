{% extends "base.html" %}

{% block head %}
<title>æ˜æ—¥ã®ãŠã™ã™ã‚åº—èˆ—éå»3å›åˆ†æ çµæœç”»é¢</title>
{% endblock %}



{% block content %}
<div class ='container'>
    <div class="row">
        <div class="col-12">
            <h1>åˆ†æçµæœ</h1>
            <div>
                <p>æ¯”è¼ƒã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯{{ user_data['tenpo-name'] }}ã®</p>
                    {% for date in target_day_list_jp %}
                    <ul class = 'day_list '>{{ date }}</ul>
                    {% endfor %}
                <p>{{serch_number}}å›åˆ†ãƒ‡ãƒ¼ã‚¿ã‚’ä»Šå›é›†è¨ˆã—ã¾ã—ãŸã€‚</p>
            </div>
        </div>
        <div class="col-12">
            <canvas id="canvas"></canvas>
        </div>

        <div class="col-12">
            <div class="scroll_area" style="width:100%;max-width:700px;overflow-x:scroll;">
                <table style="width:100%;">
                    {{samai_table|safe}}
                </table>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <h1><p>{{ user_data['tenpo-name'] }}<br>ç›´è¿‘éå»{{serch_number}}å›åˆè¨ˆåˆ†ã§æœ€ã‚‚å‡ºã¦ã„ãŸãŠå‹§ã‚æ©Ÿç¨®TOP10</p></h1>
            <div class="heading-008 my-2 ">â€»åˆè¨ˆ{{serch_number}}å›åˆ†(ãƒãƒ©ã¯é™¤ã)</div>
            <div class="heading-008 my-2 ">âœ…ãŠå‹§ã‚æ©Ÿç¨®ã¯ã“ã“ã§ç¢ºèªã—ã‚ˆã†</div>
            <div class='design16 .table-wrap'>
                <div class="scroll_area" style="width:100%;max-width:1000px;overflow-x:scroll;">
                    <table style="width:100%;">
                        {{groupby_kisyu_table|safe}}
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <h1>ãŠå‹§ã‚æ©Ÿç¨®ç·å·®æšãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆ</h1>
            <div class="heading-008 my-2 ">âœ…ã©ã®æ©Ÿç¨®ã«å¤§ããªå‡ºç‰é…åˆ†ãŒã‚ã‚‹ã‹å¯è¦–åŒ–</div>
            <div class="canvas-container">
                <canvas id="bubblechart"></canvas>
            </div>
            <h1>ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ä¸¦ã³å‚¾å‘åˆ†æ</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="heading-008 my-2 ">âœ…6å°ä¸¦ã³ã‚„ã©ã®å ´æ‰€ã«å…¥ã‚‹ã‹å‚¾å‘ãŒã‚ã‚‹ã‹ç¢ºèªï¼</div>
            <div class = 'heatmap .table-wrap'>
                <div class="scroll_area" style="width:100%;max-width:2000px;overflow-x:scroll;">
                    <table id="heatmap_table" class="table table-striped">
                        <thead>
                            <tr>
                                {% for col in heatmap_column_names %}
                                <th>
                                {{col}}
                                </th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in heatmap_row_data %}
                            <tr>
                                {% for col, row_ in zip(heatmap_column_names, row) %}
                                <td>{{row_}}</td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <h1>æ—¥åˆ¥æ©Ÿç¨®åˆ¥å·®æšé †éå»{{serch_number}}å›åˆè¨ˆãƒ‡ãƒ¼ã‚¿TOP30</h1>
            <div class="heading-008 my-2 ">å…¨å°ç³»ã¯ã“ã“ã‹ã‚‰è¦‹ã‚‹ã¨ğŸ‘</div>
            <div class="scroll_area" style="width:100%;max-width:1000px;overflow-x:scroll;">
                <table class='design17' style="width:100%;">
                    <thead>
                        <tr>
                        {% for col in column_names %}
                        <th>
                            {{col}}
                        </th>
                        {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in row_data %}
                        <tr>
                        {% for col, row_ in zip(column_names, row) %}
                        <td>{{row_}}</td>
                        {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                </div>
                </div>
                <h1>æ—¥åˆ¥æ©Ÿç¨®åˆ¥å·®æšé †ãƒ‡ãƒ¼ã‚¿TOP30</h1>
                <div class="heading-008 my-2 ">æ—¥æ¯ã®ãƒ‡ãƒ¼ã‚¿ã¯ã“ã“ã§ãƒã‚§ãƒƒã‚¯</div>
                {% for day_df , date in zip(display_day_df_list,target_day_list_jp) %}
                <ul class = 'day_list '>{{ date }}</ul>
                <div class='design16 .table-wrap'>
                    <div class="scroll_area" style="width:100%;max-width:1000px;overflow-x:scroll;">
                    <table style="width:100%;">
                        {{day_df|safe}}
                    </table>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>
<script>
window.onload = function() {
  ctx = document.getElementById("canvas").getContext("2d");
    window.myBar = new Chart(ctx, {
        type: 'bar',
        data: barChartData,
        options: complexChartOption
    });
  };
  var complexChartOption = {
  responsive: true,
  scales: {
      yAxes: [{
          id: "y-axis-1",
          type: "linear", 
          position: "left",
          ticks: {
              max: 0.2,
              min: 0,
              stepSize: 0.1
          },
      }, {
          id: "y-axis-2",
          type: "linear", 
          position: "right",
          ticks: {
              max: 1.5,
              min: 0,
              stepSize: .5
          },
          gridLines: {
              drawOnChartArea: false, 
          },
      }],
  }
};
</script>
<script>
var barChartData = {
    labels: {{ target_day_list_jp|safe }},
    datasets: [
    {
        type: 'line',
        label: 'å¹³å‡å·®æš',
        data: {{ samai_list|safe }},
        borderColor : "rgba(254,97,132,0.8)",
                pointBackgroundColor    : "rgba(254,97,132,0.8)",
                fill: false,
        yAxisID: "y-axis-1",// è¿½åŠ 
        borderWidth: 2,
        pointHoverRadius: 2,
        pointBackgroundColor: "rgba(254,97,132,0.8)",

    },
    {
        type: 'bar',
        label: 'å¹³å‡Gæ•°',
        data: {{ gamesuu_list| safe}},
        borderColor : "rgba(54,164,235,0.8)",
        backgroundColor : "rgba(54,164,235,0.5)",
        yAxisID: "y-axis-2",
    },],
};
</script>

<script>
var complexChartOption = {
    responsive: true,
    scales: {
      
        yAxes: [{
            id: "y-axis-1",
            type: "linear", 
            position: "left",
            ticks: {
                max: 700,
                min: -300,
                stepSize: 100,
                fontSize: 13,
                callback: function(value, index, values) {
                  return 'å¹³å‡' + value + 'æš';}
            },
        }, {
            id: "y-axis-2",
            type: "linear", 
            position: "right",
            ticks: {
                max: 6000,
                min: 1000,
                stepSize: 1000,
                fontSize: 13,
                callback: function(value, index, values) {
                  return  value + 'G';}
            },
            gridLines: {
                drawOnChartArea: false, 
                borderWidth: 3,
            },
        }],
    }
};
</script>
<script>
$(function(){
// ãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿
var bubleChartData = {
    datasets: [
    {% for index, row in output_bubble_chart_df.iterrows() %}
        {
            data: [{"x":{{ row['å¹³å‡Gæ•°']  }} ,"y":{{ row['å¹³å‡å·®æš'] }}, "r":{{ (row['åˆè¨ˆå·®æš'] * bubble_chart_division_calc_num) + 17 }}} ,],
            // è‰²ï¼ˆ2å€‹ç›®ï¼‰
            {% autoescape false %}
            backgroundColor:["{{ row['color'] }}"],
            {% endautoescape %}
            // ãƒ©ãƒ™ãƒ«ï¼ˆ2å€‹ç›®ï¼‰
            {% autoescape false %}
            label: ["{{ row['æ©Ÿç¨®å'] }}"]  
            {% endautoescape %}
        },
    {% endfor %}
    ]};

// ã‚ªãƒ—ã‚·ãƒ§ãƒ³
var bubble_chart_options = {
        layout: {
        font: {
            size: 13,
            weight: 'bold'
        },
        padding: {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
            }
        },
        responsive: true,
        maintainAspectRatio: false,
        legend: {             // å‡¡ä¾‹ã®è¨­å®š
        position: "bottom",     // è¡¨ç¤ºä½ç½®
        labels: {              // å‡¡ä¾‹æ–‡å­—åˆ—ã®è¨­å®š
            fontSize: 10,
        }
        },
        // ã‚¿ã‚¤ãƒˆãƒ«

        tooltips: {
        callbacks: {
            label: function(t, d) {
                var rLabel = d.datasets[t.datasetIndex].data[t.index].r;
                return d.datasets[t.datasetIndex].label + '\n'
                + 'å¹³å‡' + t.xLabel + 'G å¹³å·®' + t.yLabel + 'æš ç·å·®' + ( (rLabel /{{bubble_chart_division_calc_num}} /10000)).toFixed(1) + 'ä¸‡æš';
            }
        }
        },
            // å¹³å‡Gæ•°
        scales: {
            x: {
                ticks: {
                padding:10,    // å€‹åˆ¥è¨­å®šä¸å¯
                stepSize: 1000,
                font: {
                    size: 13,
                },
                showLabelBackdrop: true,
                backdropPadding: { x: 1, y: 2 },
                major: {
                    enabled: true,
                },
                align: 'center',
                crossAlign: 'center',
                sampleSize: 24,
                callback: function(label, index, labels) {
                    return 'å¹³å‡' + value + 'æš';}
                },
                title: {
                display: true,
                text: 'å¹³å‡Gæ•°',
                padding: {
                    top: 0,    // å³å´
                    bottom: 0  // å·¦å´
                },
                font: {
                    size: 13,
                    weight: 'bold'
                },
                color: '#000'},

            },
            y: {
            title: {
                display: true,
                text: 'å¹³å‡å·®æš',
                padding: {
                top: 0,    // å³å´
                bottom: 0  // å·¦å´
                },
                font: {
                size: 13,
                weight: 'bold'
                },
                color: '#000'},
            // æœ€å°å€¤ãƒ»æœ€å¤§å€¤
            // ç›®ç››ãƒ©ãƒ™ãƒ«
            ticks: {
                padding: 15,    // å€‹åˆ¥è¨­å®šä¸å¯
                stepSize: 1000,
                font: {
                size: 13,
                weight: 'bold'
                },
                showLabelBackdrop: true,
                backdropPadding: { x: 4, y: 2 },
                major: {
                enabled: true,
                },
                align: 'center',
                crossAlign: 'center',
                sampleSize: 24,
                callback: function(label, index, labels) {
                return label + 'æš';
                }
            },

            },
        },
};

// ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

var ctx = $("#bubblechart")[0].getContext("2d");
// ãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆã®æç”»
$(function () {
    var container = $('.canvas-container');
    var ctx= $('#bubblechart');
    ctx.attr('width', container.width());
    ctx.attr('height', 500);
});
var bubbleChart = new Chart(ctx, 
        {
            type: 'bubble',
            data: bubleChartData,
            options: bubble_chart_options
        });
});
Chart.defaults.global.defaultFontFamily = "sans-serif";
Chart.defaults.global.defaultFontSize = 13;



</script>

<script>
$(document).ready(function(){
    $("#heatmap_table").DataTable({
        "language":{url:"https://cdn.datatables.net/plug-ins/1.11.5/i18n/ja.json",},
            // ä»¶æ•°åˆ‡æ›¿æ©Ÿèƒ½ ç„¡åŠ¹
        lengthChange: false,
        // æ¤œç´¢æ©Ÿèƒ½ ç„¡åŠ¹
        searching: true,
        // ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ ç„¡åŠ¹
        ordering: true,
        // æƒ…å ±è¡¨ç¤º ç„¡åŠ¹
        info: true,
        // ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ ç„¡åŠ¹
        paging: false,
        // åˆæœŸè¡¨ç¤ºã®ä¸¦ã³æ›¿ãˆãªã—
        order: [],
        // æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’æœ‰åŠ¹ã«ã™ã‚‹ (scrollXã¯trueã‹falseã§æœ‰åŠ¹ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™)
        scrollX: true,
        // ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’æœ‰åŠ¹ã«ã™ã‚‹ (scrollYã¯200, "200px"ãªã©ã€Œæœ€å¤§ã®é«˜ã•ã€ã‚’æŒ‡å®šã—ã¾ã™)
        scrollY: 500,

        columnDefs: [
        // 2åˆ—ç›®(0ã‹ã‚‰å§‹ã¾ã‚‹ãŸã‚1ã«ãªã£ã¦ã„ã¾ã™)ã®å¹…ã‚’100pxã«ã™ã‚‹
        { targets: [0,3,6], width: 150 }
    ]


    });
});



$(document).ready(function() {
    // é…åˆ—å†…ã®æœ€å¤§å€¤ã‚’å–å¾—ã™ã‚‹é–¢æ•°
    Array.max = function(array) {
        return Math.max.apply(Math, array);
    };
    // ã™ã¹ã¦ã®å€¤ã‚’å–å¾—
    var counts = $('.heatmap td:nth-child(2)').map(function() {
        return parseInt($(this).text());
    }).get();
    // æœ€å¤§å€¤ã‚’è¿”ã™
    var plus_max = 5000;
    var minus_max =-3000;
    // è‰²ã‚’æŒ‡å®šã™ã‚‹
    xr = 255;
    xg = 255;
    xb = 255;
    
    minnus_yr = 255;
    minnus_yg = 0;
    minnus_yb = 0;

    plus_yr = 0;
    plus_yg = 0;
    plus_yb = 255;

    yr = 255;
    yg = 255;
    yb = 0;
    
    n = 100;
    // å„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’ãƒ«ãƒ¼ãƒ—ã—ã¦ã€ãã®ï¼…ã®å€¤ã‚’è¨ˆç®—ã™ã‚‹
    $('.heatmap td:nth-child(3)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        if (val > 0) {
            var pos = parseInt((Math.round((val / plus_max) * 100)).toFixed(0));
            red = parseInt((xr + ((pos * (plus_yr - xr)) / (n - 1))).toFixed(0));
            green = parseInt((xg + ((pos * (plus_yg - xg)) / (n - 1))).toFixed(0));
            blue = parseInt((xb + ((pos * (plus_yb - xb)) / (n - 1))).toFixed(0));
            clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
            if (val > 3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        } else {
            var pos = parseInt((val / minus_max) * 100).toFixed(0);
            green = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            blue = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            clr = 'rgb(' + 255 + ',' + green + ',' + blue + ')';
            console.log(clr);
            if (val < -3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        }
    });
    $('.heatmap td:nth-child(6)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        if (val > 0) {
            var pos = parseInt((Math.round((val / plus_max) * 100)).toFixed(0));
            red = parseInt((xr + ((pos * (plus_yr - xr)) / (n - 1))).toFixed(0));
            green = parseInt((xg + ((pos * (plus_yg - xg)) / (n - 1))).toFixed(0));
            blue = parseInt((xb + ((pos * (plus_yb - xb)) / (n - 1))).toFixed(0));
            clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
            if (val > 3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        } else {
            var pos = parseInt((val / minus_max) * 100).toFixed(0);
            green = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            blue = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            clr = 'rgb(' + 255 + ',' + green + ',' + blue + ')';
            console.log(clr);
            if (val < -3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        }
    });
    $('.heatmap td:nth-child(9)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        if (val > 0) {
            var pos = parseInt((Math.round((val / plus_max) * 100)).toFixed(0));
            red = parseInt((xr + ((pos * (plus_yr - xr)) / (n - 1))).toFixed(0));
            green = parseInt((xg + ((pos * (plus_yg - xg)) / (n - 1))).toFixed(0));
            blue = parseInt((xb + ((pos * (plus_yb - xb)) / (n - 1))).toFixed(0));
            clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
            if (val > 3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        } else {
            var pos = parseInt((val / minus_max) * 100).toFixed(0);
            green = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            blue = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            clr = 'rgb(' + 255 + ',' + green + ',' + blue + ')';
            console.log(clr);
            if (val < -3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        }
    });
    $('.heatmap td:nth-child(12)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        if (val > 0) {
            var pos = parseInt((Math.round((val / plus_max) * 100)).toFixed(0));
            red = parseInt((xr + ((pos * (plus_yr - xr)) / (n - 1))).toFixed(0));
            green = parseInt((xg + ((pos * (plus_yg - xg)) / (n - 1))).toFixed(0));
            blue = parseInt((xb + ((pos * (plus_yb - xb)) / (n - 1))).toFixed(0));
            clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
            if (val > 3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        } else {
            var pos = parseInt((val / minus_max) * 100).toFixed(0);
            green = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            blue = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            clr = 'rgb(' + 255 + ',' + green + ',' + blue + ')';
            console.log(clr);
            if (val < -3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        }
    });
    $('.heatmap td:nth-child(15)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        if (val > 0) {
            var pos = parseInt((Math.round((val / plus_max) * 100)).toFixed(0));
            red = parseInt((xr + ((pos * (plus_yr - xr)) / (n - 1))).toFixed(0));
            green = parseInt((xg + ((pos * (plus_yg - xg)) / (n - 1))).toFixed(0));
            blue = parseInt((xb + ((pos * (plus_yb - xb)) / (n - 1))).toFixed(0));
            clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
            if (val > 3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        } else {
            var pos = parseInt((val / minus_max) * 100).toFixed(0);
            green = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            blue = parseInt((minnus_yr + ((pos * (0 - minnus_yr)) / 100))).toFixed(0);
            clr = 'rgb(' + 255 + ',' + green + ',' + blue + ')';
            console.log(clr);
            if (val < -3000) {
                $(this).css({
                    backgroundColor: clr,
                    color: 'white',
                    fontWeight: 'bold'
                });
            } else {
                $(this).css({
                    backgroundColor: clr
                });
            }
        }
    });
    xr = 255;
    xg = 255;
    xb = 255;

    yr = 0;
    yg = 0;
    yb = 255;

    $('.heatmap td:nth-child(2)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        var max = 8000;
        var pos = parseInt((Math.round((val / max) * 100)).toFixed(0));
        red = parseInt((xr + ((pos * (yr - xr)) / (n - 1))).toFixed(0));
        green = parseInt((xg + ((pos * (yg - xg)) / (n - 1))).toFixed(0));
        blue = parseInt((xb + ((pos * (yb - xb)) / (n - 1))).toFixed(0));
        clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
        if (val > 6000) {
            $(this).css({
                backgroundColor: clr,
                color: 'white',
                fontWeight: 'bold'
            });
        } else {
            $(this).css({
                backgroundColor: clr
            });
        }
    });
    $('.heatmap td:nth-child(5)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        var max = 10000;
        var pos = parseInt((Math.round((val / max) * 100)).toFixed(0));
        red = parseInt((xr + ((pos * (yr - xr)) / (n - 1))).toFixed(0));
        green = parseInt((xg + ((pos * (yg - xg)) / (n - 1))).toFixed(0));
        blue = parseInt((xb + ((pos * (yb - xb)) / (n - 1))).toFixed(0));
        clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
        if (val > 6000) {
            $(this).css({
                backgroundColor: clr,
                color: 'white',
                fontWeight: 'bold'
            });
        } else {
            $(this).css({
                backgroundColor: clr
            });
        }
    });
    $('.heatmap td:nth-child(8)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        var max = 8000;
        var pos = parseInt((Math.round((val / max) * 100)).toFixed(0));
        red = parseInt((xr + ((pos * (yr - xr)) / (n - 1))).toFixed(0));
        green = parseInt((xg + ((pos * (yg - xg)) / (n - 1))).toFixed(0));
        blue = parseInt((xb + ((pos * (yb - xb)) / (n - 1))).toFixed(0));
        clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
        if (val > 6000) {
            $(this).css({
                backgroundColor: clr,
                color: 'white',
                fontWeight: 'bold'
            });
        } else {
            $(this).css({
                backgroundColor: clr
            });
        }
    });
    $('.heatmap td:nth-child(11)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        var max = 8000;
        var pos = parseInt((Math.round((val / max) * 100)).toFixed(0));
        red = parseInt((xr + ((pos * (yr - xr)) / (n - 1))).toFixed(0));
        green = parseInt((xg + ((pos * (yg - xg)) / (n - 1))).toFixed(0));
        blue = parseInt((xb + ((pos * (yb - xb)) / (n - 1))).toFixed(0));
        clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
        if (val > 6000) {
            $(this).css({
                backgroundColor: clr,
                color: 'white',
                fontWeight: 'bold'
            });
        } else {
            $(this).css({
                backgroundColor: clr
            });
        }
    });
    $('.heatmap td:nth-child(14)').each(function() {
        var val = parseInt($(this).text());
        console.log(val);
        var max = 8000;
        var pos = parseInt((Math.round((val / max) * 100)).toFixed(0));
        red = parseInt((xr + ((pos * (yr - xr)) / (n - 1))).toFixed(0));
        green = parseInt((xg + ((pos * (yg - xg)) / (n - 1))).toFixed(0));
        blue = parseInt((xb + ((pos * (yb - xb)) / (n - 1))).toFixed(0));
        clr = 'rgb(' + red + ',' + green + ',' + blue + ')';
        if (val > 6000) {
            $(this).css({
                backgroundColor: clr,
                color: 'white',
                fontWeight: 'bold'
            });
        } else {
            $(this).css({
                backgroundColor: clr
            });
        }
    });
});
</script>

{% endblock %}